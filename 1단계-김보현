import pandas as pd

# CSV íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
map_df = pd.read_csv('area_map.csv')
struct_df = pd.read_csv('area_struct.csv')
category_df = pd.read_csv('area_category.csv')

#êµ¬ì¡°ë¬¼ IDë¥¼ ì´ë¦„ìœ¼ë¡œ ë³€í™˜ (ì¹´í…Œê³ ë¦¬ ì´ë¦„ ë§¤í•‘)
struct_df = struct_df.merge(category_df, how='left', left_on='structure_id', right_on='id')
struct_df = struct_df.drop(columns=['id']) 
struct_df = struct_df.rename(columns={'name': 'structure_name'})

#ë°ì´í„° ë³‘í•©
merged_df = map_df.merge(struct_df, on='structure_id', how='left')

#area ê¸°ì¤€ ì •ë ¬
merged_df = merged_df.sort_values(by='area')

#area 1 ë°ì´í„°ë§Œ í•„í„°ë§
area1_df = merged_df[merged_df['area'] == 1]

#ê²°ê³¼ ì¶œë ¥
print("ğŸ” Area 1 ë°ì´í„°:")
print(area1_df)

#(ë³´ë„ˆìŠ¤) êµ¬ì¡°ë¬¼ ì¢…ë¥˜ë³„ ìš”ì•½ í†µê³„
summary = area1_df['structure_name'].value_counts().reset_index()
summary.columns = ['Structure Type', 'Count']


print("\nğŸ“Š êµ¬ì¡°ë¬¼ ì¢…ë¥˜ë³„ ìš”ì•½ í†µê³„:")
print(summary)

python mas_map.py

